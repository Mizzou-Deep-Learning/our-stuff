from Tkinter import Tk
from tkFileDialog import askopenfilename
import pandas as pd
import numpy as np
import matplotlib
matplotlib.use("tkAgg")
import matplotlib.pyplot as plt
import scipy.fftpack
from scipy import signal


Tk().withdraw()
filename = 'training_mood.csv'#askopenfilename()
Utime = 23
Ltime = 0
fields =['period', 'time','HR']
df = pd.read_csv(filename, usecols=fields)
#ddf = df.dropna()
ddf = df
print ddf
#plt.show( ddf.plot(kind = 'scatter', x = 'time' , y = 'HR', c = 'c'))
#ddf = ddf[ddf.time%2 == 0]
NFFT = 32       # the length of the windowing segments
Fs = 2#len(ddf['HR'])#len(ddf['HR'])  # the sampling frequency       ### THIS IS THE Y AXIS

imgNum = 0
ddf = ddf[ddf.period == '10/3/2014']

step = 1
for imgNum in np.arange(Ltime, Utime,step):
    plt.cla()
    plt.clf()
    dddf = ddf
    print imgNum
    print imgNum + step
    dddf = dddf[dddf.time > imgNum]
    dddf = dddf[dddf.time < imgNum + step]
    print len(dddf['period'])
    print len(ddf['period'])
    #print dddf
    ax = plt.subplot(111)
    plt.axis('off')
    Pxx, freqs, bins, im = plt.specgram(dddf['HR'], NFFT=NFFT, pad_to=NFFT, noverlap=31, Fs=Fs)#,
    plt.savefig('pic' + str(imgNum) + '.png', bbox_inches='tight', pad_inches = 0)
    #plt.show()
